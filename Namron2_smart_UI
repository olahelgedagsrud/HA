blueprint:
  name: Namron K4 – Zigbee2MQTT (Smart-UI compatible)
  description: Fully compatible MQTT-based blueprint with working Smart-UI action fields.
  domain: automation

  input:
    zigbee_device:
      name: Zigbee2MQTT Device
      description: Select your Namron K4 device
      selector:
        device:
          filter:
            - integration: mqtt

    # Channel 1
    ch1_on:
      name: Channel 1 – ON
      selector:
        object: {}
      default: []

    ch1_off:
      name: Channel 1 – OFF
      selector:
        object: {}
      default: []

    ch1_bright_up:
      name: Channel 1 – Brightness Up (hold)
      selector:
        object: {}
      default: []

    ch1_bright_down:
      name: Channel 1 – Brightness Down (hold)
      selector:
        object: {}
      default: []

    ch1_bright_stop:
      name: Channel 1 – Stop dim (release)
      selector:
        object: {}
      default: []

    # Channel 2
    ch2_on:
      name: Channel 2 – ON
      selector:
        object: {}
      default: []

    ch2_off:
      name: Channel 2 – OFF
      selector:
        object: {}
      default: []

    ch2_bright_up:
      name: Channel 2 – Brightness Up (hold)
      selector:
        object: {}
      default: []

    ch2_bright_down:
      name: Channel 2 – Brightness Down (hold)
      selector:
        object: {}
      default: []

    ch2_bright_stop:
      name: Channel 2 – Stop dim (release)
      selector:
        object: {}
      default: []

trigger_variables:
  dev: !input zigbee_device
  z2m: "{{ device_attr(dev, 'name') | lower | replace(' ', '_') }}"

trigger:
  - platform: mqtt
    topic: "zigbee2mqtt/{{ z2m }}/action"

condition: []

action:
  - choose:

      # ----- CHANNEL 1 -----
      - conditions: "{{ trigger.payload == 'on_l1' }}"
        sequence: !input ch1_on

      - conditions: "{{ trigger.payload == 'off_l1' }}"
        sequence: !input ch1_off

      - conditions: "{{ trigger.payload == 'brightness_move_up_l1' }}"
        sequence: !input ch1_bright_up

      - conditions: "{{ trigger.payload == 'brightness_move_down_l1' }}"
        sequence: !input ch1_bright_down

      - conditions: "{{ trigger.payload == 'brightness_stop_l1' }}"
        sequence: !input ch1_bright_stop

      # ----- CHANNEL 2 -----
      - conditions: "{{ trigger.payload == 'on_l2' }}"
        sequence: !input ch2_on

      - conditions: "{{ trigger.payload == 'off_l2' }}"
        sequence: !input ch2_off

      - conditions: "{{ trigger.payload == 'brightness_move_up_l2' }}"
        sequence: !input ch2_bright_up

      - conditions: "{{ trigger.payload == 'brightness_move_down_l2' }}"
        sequence: !input ch2_bright_down

      - conditions: "{{ trigger.payload == 'brightness_stop_l2' }}"
        sequence: !input ch2_bright_stop
